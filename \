#include <stdlib.h>
#include "chromosome.h"
#include "newgenselection.h"


struct chromosome* fmax_selection(struct chromosome *population, 
        struct chromosome* childs, int size)
{
    struct chromosome* newpopulation = 
        (struct chromosome*)malloc(sizeof(struct chromosome) * size);

    int fmin = population[0].fitness;
    int imax = 0;
    int p = 0; /* imax из родителей или сыновей TODO: костыльно */
    for (int k = 0; k < size; k++) {
        for (int i = 0; i < size * 2; i++) {
            if (fmax < population[i].fitness) {
                fmax = population[i].fitness;
                p = 1;
                imax = i;
            }

            if (fmax < childs[i].fitness) {
                fmax = childs[i].fitness;
                p = 0;
                imax = i;
            }
        }

        if (p == 1) {
            newpopulation[k].x = population[imax].x;
            newpopulation[k].fitness = population[imax].fitness;
            newpopulation[k].id = population[imax].id;
        }
        else {
            newpopulation[k].x = childs[imax];
            newpopulation[k].fitness = childs[imax];
            newpopulation[k].id = childs[imax];
        }

    }

    return population; /* TODO: есть ли вообще смысл возвращать? */
}
